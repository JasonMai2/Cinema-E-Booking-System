# .env.example - copy to .env and fill sensitive values
MYSQL_ROOT_PASSWORD=rootpw
MYSQL_DATABASE=ecinema
MYSQL_USER=cinemae
MYSQL_PASSWORD=devsecret

# optional: host port mapping for MySQL (host:container)
MYSQL_HOST_PORT=3307

# 1) clone repo, copy env
git clone <repo-url>
cd <repo>
cp .env.example .env   # edit if needed

# 2) start the DB
docker compose up -d mysql

# 3) wait until healthy (optional)
docker compose ps
docker compose logs -f mysql  # watch initialization, then Ctrl-C when ready

# 4) import schema (one-time)
# from repo root (where ecinema.sql lives)
( echo 'SET FOREIGN_KEY_CHECKS=0;'; cat ecinema.sql; echo 'SET FOREIGN_KEY_CHECKS=1;' ) \
  | docker exec -i cinemae-mysql mysql -uroot -p"${MYSQL_ROOT_PASSWORD}" ${MYSQL_DATABASE}

# 5) optionally import demo data
docker exec -i cinemae-mysql mysql -uroot -p"${MYSQL_ROOT_PASSWORD}" ${MYSQL_DATABASE} < seed_demo.sql
